\newif\ifdraft
\drafttrue

\documentclass[E]{BAMASA}
\usepackage{xspace}
\usepackage{natbib}
\usepackage[normalem]{ulem} %for \sout strikeout

\renewcommand{\asst}{Matilda Backendal, \new{David Balbás, Miro Haller}\\
Matteo Scarlata}

\usepackage[usenames,dvipsnames]{xcolor}

\usepackage[colorlinks=true,linkcolor=Blue,urlcolor=Blue,citecolor=Blue]{hyperref}


%
% draft-mode macros
%
\ifdraft
\newcommand{\TODO}[1]{{\color{Red}\textbf{TODO:} #1}}
\newcommand{\new}[1]{{\color{OliveGreen}#1}}
\newcommand{\old}[1]{{\color{RawSienna}\ifmmode\text{\sout{\ensuremath{#1}}}\else\sout{#1}\fi}}
\newcommand{\replace}[2]{\old{#1}\new{#2}}
\newcommand{\mb}[1]{{\color{Green}{\textbf{mb:} #1}}}
\newcommand{\nd}[1]{{\color{Orange}{\textbf{nd:} #1}}}
\fi


\begin{document}

%In the line below, use the "\MA" flag for a Master's thesis or the "\BA" flag for a Bachelor's thesis. 
\MA{TBD, 2024}{TBD, 2024}%
{Nicola Dardanis}%
{Implementing a Secure File Sharing System}


\intro
In the Internet era, data creation and collection has reached new peak levels.
More and more personal data is communicated through, stored at and analyzed by services such as messaging apps, social media and online file storage.
Concurrently, a concern about privacy for all this outsourced data has sailed up as an important topic, both legally, politically and for private individuals.
Control of what data is collected, where it is stored and how it is used is largely outside the control of the data owners.
Nonetheless, the functionality provided by these services is too beneficial for most companies and consumers to abstain from.
The consequence is that even highly sensitive data, such as for example medical records, whistle-blower material and regime-critical protester plans, end up on the servers of online application service providers.

Fortunately, cryptography has simultaneously made giant leaps forward in securing the confidentiality and authenticity of data in transit against strong adversaries.
End-to-end encryption (E2EE) is now the norm for Internet browsing (via TLS) and increasingly also for messaging (with apps such as WhatsApp and Signal being end-to-end encrypted by default).
Somewhat surprisingly, services that offer outsourced data storage, such as cloud storage and collaborative file editing platforms, still lag behind.
One of the explanations might be the complexity that arises due to the persistence of data, which makes it difficult to use ephemeral key material to achieve strong security guarantees such as forward secrecy (FS) and post-compromise security (PCS).
Another is the lack of a formal security models for even basic E2E security of outsourced data storage supporting functionality such as file sharing between users.
In particular, the number of potential end-points arising from file sharing increases the complexity of E2EE cloud storage compared to single client settings.

This complexity also exists in messaging, as showcased by the fact that protocols for secure two-party messaging (such as e.g.\ the Signal protocol) have been around for quite some time, but a protocol for E2EE group chats was only very recently standardized~\cite{rfc9420}.
The newly standardized group messaging protocol is called ``messaging layer security'' (MLS).
One of the main motivations for MLS was to make E2E security for messaging in groups of size $n$ more efficient than through the naïve construction of $n^2$ two-party channels, while still retaining the same high-security guarantees, including forward secrecy and post-compromise security, that we expect from modern secure messaging protocols.

At its core, MLS uses a primitive called continuous group key agreement (CGKA) to generate and exchange group keys.
The group key is only available to current group members, and when the group membership changes (causing a so called ``epoch'' shift), the group key is updated such that only the members of the new group get the new key.
CGKA comes in many different variants, with different syntaxes and associated functionalities.
In particular, recent CGKA schemes provide restrictions on which parties can perform certain group membership operations (such as adding and removing users);
this is known as administrated CGKA (A-CGKA)~\cite{USENIX:BalColVau23}.

In MLS, the CGKA group key is used by an application layer to provide the functionality required for a group messaging protocol.


In this project, we will explore the possibilities for more advanced security guarantees for file sharing systems in the E2EE setting.
In particular, we will aim to tackle the conflict between the required functionality (including persistent data access, and flexible group and access management) and strong security guarantees such as FS and PCS.
Our initial attempt at a solution, which we call the ``secure shared folder'' (SSF) scheme, combines the recent advancements of group messaging from the MLS standard with a form of key ratcheting known as key regression~\cite{NDSS:FuKamKoh06}.




\desc
The main aim of the project is to implement a proof of concept of the SSF scheme.
The implementation should be conducted following the best engineering practices 
and should guarantee the security expressed in the theory.
The main features of the protocol will be developed to have at least a minimum viable 
product (MVP) implementation.

As a preliminary task, a suitable baseline to benchmark the SSF system against should be developed.
During this phase, it is important to define the programming platform, including language 
and targeted ecosystem for which we would like the final implementation to be supported, 
and what should be part of the minimum viable product (MVP).
The baseline should provide one or more na\"ive construction of the same MVP and would 
also take inspiration from the available mainstream products available in the market.
This will guarantee that the minimal set of features selected will make the overall system usable.

The main part of the project will be dedicated on implementing the theoretical construction, 
which should be fully specified by the end of the baseline implementation. 
The implementation will first provide a command line interface (CLI) to replicate 
all the features included in the baseline.
After benchmarking the initial artifact, optimisations will be explored. 

If time will permit it, extensions such as a graphical interface and functionalities 
commonly needed to ease the use of file sharing systems will be researched and implemented.
A secondary aim of the project is studying what would make a usable system in the real world.
This ``industrial'' research will pose questions over the theoretical construction and the 
trade-offs that are taken.
To satisfy the above enquire, the panorama of solutions already present in the industry and 
their security and trade-offs could be explored as an extension to this project, comparing
the features and guarantees normally available to users in the mainstream products with what
the SSF system can offer.
This could also lead to design a more real-world suitable system, by studying the personas~\cite{norman2002design} 
that could form the audience for a more secure but more feature-limited system.

Finally, in academic terms, the SSF implementation artifact as well as the baseline will be
valuable to present concrete results 
over the viability and efficiency of the theoretical construction.




\tasks
\begin{workpackage}{Background research and literature review}\label{wp:background}
Review the cryptographic primitives used by the theoretical construction. A non-exhaustive list of literature review will include the following papers and documentations:
\begin{itemize}
    \item On Ends-to-Ends Encryption: Asynchronous Group Messaging with Strong Security Guarantees, K. Cohn-Gordon et al.~\cite{CCS:CCGMM18}
    \item On The Insider Security of MLS, J. Alwen et al.~\cite{CCS:AHKM22}
    \item The Messaging Layer Security (MLS) Protocol, R. Barnes et al.~\cite{rfc9420};
    \item Continuous group key agreement with active security, J. Alwen et al.~\cite{TCC:ACJM20}
    \item  Cryptographic administration for secure
group messaging, D. Balb\'as et al.~\cite{USENIX:BalColVau23}
    \item Key Regression: Enabling Efficient Key Distribution for Secure Distributed Storage, K. Fu et al.~\cite{NDSS:FuKamKoh06}
    \item Continuous Group Key Agreement with Flexible Authorization and Its Applications, K. Kajita et al.~\cite{IWSPA:KEONO23}
    \item Fork-Resilient Continuous Group Key Agreement, J. Alwen et al.~\cite{C:AlwMulTse23}
    \item Server-Aided Continuous Group Key Agreement, J. Alwen et al.~\cite{CCS:AHKM22}
    \item WhatsUpp with Sender Keys? Analysis, Improvements and Security Proofs, D. Balb\'as et al.~\cite{AC:BalColGaj23}
    \item Keep the Dirt: Tainted TreeKEM, Adaptively and Actively Secure Continuous Group Key Agreement, J. Alwen et al.~\cite{SP:KPWKCCMYAP21}
    \item TreeKEM: Asynchronous Decentralized Key Management for Large Dynamic Groups A protocol proposal for Messaging Layer Security (MLS), K Bharghavan et al.~\cite{TreeKEM}
\end{itemize} 

Explore available libraries implementing the above cryptographic primitives and define 
the programming language and ecosystem which will be used. 
Some available implementations:
\begin{itemize}
    \item a list is provided by the MLS Working Group:~\cite{MLSWGimpl}
    \item AWS mls-rs~\cite{AWSMLSrs}
    \item TreeKEM~\cite{TreeKEMimpl}
\end{itemize}

Other than conducting the above survey, participate in the meetings and discussions around the theoretical model and contribute ideas to the SSF scheme.

\end{workpackage}

\begin{workpackage}{System requirements: functionality and security goals}\label{wp:system-reqs}
    Due to the flexibility of CGKA in combination with key regression, the shared folder scheme 
    can cater to a variety of different requirements and threat models.
    This is part of the goal of the theoretical side of this project: 
    ideally, we wish do develop a system which, depending on the strength of the adversary, 
    provides different levels of security.
    However, one instantiation of the scheme might not be able to cater to all levels of threats 
    simultaneously.
    For example, certain strong security requirements might be incompatible with the functionality 
    that we would like in a weaker threat model.
    Hence, the implementation needs to restrict the setting such that the system requirements are clear.
    
    The focus of this work package is to pick a threat model which will be the (initial) focus 
    of the implemented system.
    This consist in motiving the choice and specify the functionality which the system should provide 
    in this threat model and define (informally) the corresponding security goals.
    In particular, specify:
    \begin{itemize}
        \item how a correct system works, and which functionality it provides to users in a setting 
                where all parties are honest, and
        \item which types of adversaries and attacks the system should protect against.
    \end{itemize}
\end{workpackage}

\begin{workpackage}{Reference implementation}\label{wp:benchmark-baseline}
	Implement a suitable baseline to benchmark the secure shared folder protocol against.
    The programming ecosystem, which language and which runtime environment, will be 
    chosen based on the availability of required cryptographic primitives, 
    the security deriving from such a programming language or use of libraries,
    and the possibility to easily evolve the implementation into an accessible and usable product.
    The implementation is concerned with the client library, while the server side will use a 
    mainstream commercial cloud storage.
    The baseline will include:
    \begin{itemize}
		\item setting up a folder
		\item adding new files to the folder
		\item sharing the folder with other users
	\end{itemize}
    Notice that with this set of operations we can already support, although na\''ively, removal of 
    a member from a group. All is needed is to set up a new folder with all the users in the old group
    except the one to be removed.

    More specifically, the baseline will be implemented in the following way:
    \begin{itemize}
        \item assume the existence of a public key infrastructure (PKI)
        \item let every shared folder have a symmetric key, with which all the files in the 
                folder are encrypted
        \item sharing is implemented by sharing the folder key over the PKI
        \item there are no advanced security guarantees
        \item in particular, there is no group management beyond adding new users, and no forward 
                security or post-compromise security
    \end{itemize}

    Addition of functionalities or security guarantees to the baseline will be conducted 
    when relevant to benchmark the SSF. Particular focus will be given on which security guarantee 
    defined in WP\ref{wp:benchmark-baseline} are achievable in a naive system and at what cost.

\end{workpackage}

\begin{workpackage}{Implement CGKA}\label{wp:impl-cgka}
    Before implementing CGKA ourselves, we will explore the possibility of using an existing library.
    CGKA is part of the MLS protocol, and the protocol itself defines an \texttt{exporter interface} which
    seems suitable for our purposes. 
    The interface is essentially a pseudo random function (PRF) on the epoch secret, but it also ensures 
    proper domain separation with other secrets (init, membership etc).

    The AWS rust library~\cite{AWSMLSrs} offers a \texttt{export\_secret} method in module 
    \texttt{mls\_rs::group::Group} to produce the current exporter secret. In addition, disabling the \texttt{private\_message} feature 
    will exclude all non-CGKA related features from compilation.

    The BouncyCastle~\cite{BouncyCastle} Java implementation, contained in the mls package, also seems to expose the
    low-level API for group management.

    Both libraries above are still under active development. Other solutions might be considering
    implementation of the TreeKEM protocol~\cite{TreeKEMimpl}.

    If none of the above libraries (and others that might be found) will be suitable, an implementation of
    the CGKA protocol will be also taken up as part of this work package.
    

\end{workpackage}

\begin{workpackage}{Implement the secure shared folder system}\label{wp:impl-ssf}
    Adapt or implement a CGKA library for the purpose of developing secure file sharing system. The MLS internally implements a CGKA module, and defines  
	Implement the theoretical construction. Develop at first a CLI, which will include all the functionalities in scope for the MVP. Whenever possible, improve on the resiliency and scalability of the solution without compromising the security of the overall system.
\end{workpackage}

\begin{workpackage}{Benchmarking}\label{wp:benchmark}
	Benchmark the implementation and analyze its efficiency and security in practice. The results should make clear what part of the resources spent (e.g. time, memory, storage) are consumed by the cryptographic constructions. Further, the analysis should also include resiliency and availability considerations, both for the baseline and the proposed system.  
\end{workpackage}

\subsection{Extensions}

\begin{workpackage}{Extensions}\label{wp:extension}
	Explore one or more extensions to enhance the functionalities of the system. The extensions could lead to a more user-friendly product and an enhanced set of features (like multi device support, a GUI, etc.). Furthermore, the exploration of extensions, could also contribute on understanding the viability of the implemented protocol to serve as a base for further constructions.
\end{workpackage}

\begin{workpackage}{Adjust the threat model}\label{wp:adjusted-thread-model}
    
\end{workpackage}

\begin{workpackage}{Implement the new design}\label{wp:new-design}
    
\end{workpackage}

\begin{workpackage}{Benchmark and compare the three implementations}\label{wp:new-implementation}
    
\end{workpackage}


%In the line below, use "\gradingMA" for a Master's thesis or "\gradingBA" for a Bachelor's thesis
\gradingMA




\bibliography{cryptobib/abbrev3,cryptobib/crypto,references}

\end{document}
